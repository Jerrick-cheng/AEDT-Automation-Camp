Q. 自動化程式可以帶來什麼好處？

A. 完成一個複雜模擬需要上百個操作步驟才能完成。對於固定的應用(比方說天線設計)而言，某些操作步驟是固定的(比方說設Port, 設Radiation boundary，輸出天線參數)。如果這些固定操作步驟可以寫進到腳本之中，一鍵完成執行。一方面縮短操作時間，又避免了設定出錯的機會，一舉兩得。

對團隊來說，自動化程式可以統合模擬設定方法，避免個人對於模擬設定的見解不同發生模擬結果不一致的狀況發生。

---

Q. 我需要很會寫Python程式才能在AEDT上開發自動化程式嗎？

A. 不需要，自動化程式不會用到複雜的語法，只要知道下面這些就夠了：
- 基本型別及運算: string, int, float, boolean
- 基本型別資料結構及運算： list, tuple, dictionary
- 控制：if, else
- 迴圈：for, continue, break
- 匯入：Import
- 檔案讀寫函數：Open(), Close()
- 函數定義 def foo():
- 類別定義 class foo():

---

Q. 是不是學會Python就可以開發自動化程式了

A. 並不是。除了基本語法之外，你還要熟悉以下這些函式庫，你才能透過Python控制函式庫來與AEDT互動
- 基本函式庫：math, os, sys,...
- 進階函式庫：re, tkinter, matplotlib,...
- AEDT函式庫：Project, Design, Edit, Module

熟悉的意思並不是要背下所有的函式以及參數，而是要知道函式庫提供了何種功能，可以解決何種問題。只要知道如何發問問題，便可以透過Google找到答案。

---
Q. AEDT使用的是Iron Python，這和一般的Python有何差別？

A. 一般的Python又稱為Cpython。兩者的語法是類似的，內建基本函式庫也相同。但是目前多數科學用函式庫如Matplotlib，Scipy及Numpy僅支援Cpython。Iron Python主要建構在微軟的.NET框架，好處是可以使用到WPF技術在AEDT當中建立使用者介面。兩者都可以讀寫EXCEL或PPT，但是各自使用不同的函式庫。此外，目前Cpython已來到3.8版，而Iron Python仍停留在2.7版。已經會CPython的很容易就可以習慣IronPython。

---

Q. 可以從哪些步驟切入模擬自動化？

A. 初學者可以考慮下面幾個方向：
1. 前處理。比方說是建模，設port，合成電路原理圖等等。
2. 後處理。比方說是匯出模擬資料並生成報告，輸出模擬資源等。
3. 簡化操作。將多個步驟連接成單一步驟，並連接到熱鍵。

---

Q. 可以介紹"前處理"自動化嗎？

A. 在執行模擬之前，我們必須先完成設計或3D建模，材料庫的設定，Port的設置等等。對於某些設計，上述所提到的工作相當的繁複。例如大型天線陣列。手動設置往往曠日廢時又容易出錯。此時便可以透過前處理自動化來加速完成。前處理自動化主要是透過呼叫AEDT的API(Application Programming Interface)函式來完成建模或加入新的材料等等。一般開發前處理自動化程式的方式是先行錄製一段操作，再加以修改擴充。比方說是加入迴圈來重複其操作，以節省人為操作所耗費的時間。錄製的Python程式可以用一般文字編輯器加以修改，個人偏好Notepad++。

---

Q. 可以簡單描述"前處理"自動化的流程嗎？

A. 首先是錄製腳本，如果操作步驟繁複，可以分段錄製到不同的腳本當中。接下來將不同功能的程式碼包裝到不同函式當中，只留下需要的參數即可。每當包裝完一組程式碼，隨即編寫測試程式，如有必要可以用AddWarningMessage()將函式當中的變數輸出到AEDT的訊息視窗當中來協助除錯。最後串接所有程式之後進行完整功能測試。一切無誤，再視需要編寫使用者介面，並連結功能碼及使用者介面碼，完成開發工作。最後便是編寫使用說明並發布。
1. 錄製腳本
2. 函式包裝及測試
3. 整合函式並完成系統測試
4. 加入使用者介面
5. 編寫說明並發布

---


Q. 可以說明"後處理"自動化嗎？

A. 後處理指的是模擬後的資料處理。模擬的大量資料產出提供了設計的重要訊息，AEDT當中的各式報表可以支持大部分的需求，比方說是XY圖，表格，密度分布圖等等。但是一旦要分析的資料較為複雜，Report無法勝任時，我們便需要將模擬完成的原始資料匯出到第三方軟體(如Matlab, Python)來分析。這部分牽涉了資料匯出、運算、視覺化、排版等等。需要自動化來簡化這一連串的瑣碎流程。舉例來說，一組複雜的QFN封裝完成模擬之後，生成了上百組的RLC等效電路模型，便可以透過腳本快速找出RLC值超出標準的腳位，而不需要人工逐條檢視紀錄。

Anaconda支援了Pythoon語言，並支援Numpy及Scipy科學運算庫，Matplotlib繪圖庫，目前已在各個科學運算領域取代了Matlab成為工程師的首選，再加上其為開源軟體，可無償使用。是後處理自動化的首選。

---

Q. 在AEDT執行自動化程式的方式有哪些？

A. 主要方法有下列幾種：
- 從Automation執行script
- 從Toolkit執行script
- 熱鍵執行script
- ACT啟動GUI以執行script
- UDO(User Defined Outout)，建立客製化方程式
- UDP(User Defined Primitive)，建立客製化3D模型
- 將資料輸出到外部用Cpython處理(Anaconda)
- 透過批次檔控制AEDT完成前處理及後處理

---

Q. 完成一個AEDT自動化程式要多久時間？最大的困難是什麼？

A. 簡單的程式數十行代碼即可完成，開發時間不過數十分鐘。複雜的幾千行，開發時間需要數天到數周。這當然跟工程師對程式設計的掌握度及AEDT的熟悉度有絕對的關係。開發自動化程式需要使用到AEDT的函式庫，找到所需的函式並熟悉函式的輸出入是最花時間的地方。單單HFSS就提供了上千個函式，如果要透過人工從無到有開發自動化程式其工作量不敢想像。所幸AEDT可以讓使用者錄製操作步驟並輸出腳本，這約莫節省了80%函式查詢及學習的時間。另外20%的函數是"查詢"相關的函式無法透過錄製得到，便需要查找文件。

---

Q. 可以簡單介紹一下AEDT的函式庫嗎？

A. AEDT函式庫分成Desktop, Project, Design, Editor, Module等大類，Module底下又分成多個小類。比方說是要在專案底下加入新的設計，我們便可以使用oProject.InsertDesign()函數來完成。從功能區分，可分成CURD(Create:
建立, Update:更新, Read:讀取, Delete:刪除)四大塊。比方說是InsertDesign()屬於建立, SetActiveDesign()算是更新，GetName()屬於讀取，CutDesign()屬於刪除。當中CUD類可以透過錄製得到，而R類需要透過文件來查找。關於函式庫的Help檔可以在C:\Program Files\AnsysEM\AnsysEM20.1\Win64\Help底下找到ScriptingGuide.pdf當中詳細說明了函式的功能及使用方法。

---

Q. 如何讓使用者輸入參數到腳本當中？

A. 由易到難，有下列幾種方法：
1. 讓使用者在AEDT Properties視窗輸入參數，缺點是無法建立複雜的控件，如下拉式選單，或Radio Button。
2. 建立使用者介面。在Iron Python當中，有兩種方法可以產生使用者介面：
    - Tkinter (Linux & Windows)，用代碼方式編寫，較為繁複。
    - WPF (Windows)，可用拖放方法建立GUI，程式與介面分離。
3. 包裝成ACT(ANSYS Customization Toolkit)，ACT當中有較多控件可以使用。

---

Q. 如何不讓別人看到我腳本的程式碼？

A. 有兩種手段:
1. 編譯成.dll
2. 包裝成ACT(ANSYS Customization Toolkit)

---

Q. 可以說明ACT(ANSYS Customization Toolkit)嗎？

A. ACT是一種外掛套件的技術，在ANSYS的軟件上可以外掛ACT套件來提供額外的功能。由於軟體工具不可能滿足所有的需求，工程師便可以根據自己的需求編寫程式碼在ACT框架當中，來達到特定功能的需求。舉例來說，HFSS當中提供了Antenna ACT，使用者只要輸入頻段並選擇天線結構，ACT便自動生成天線3D模型，省去使用者建立模型的功夫。本質也是自動化的一種。與Script不同的是：
. 提供加密保護
. 支持簡單的GUI介面
. 可上架發售，App Store: https://catalog.ansys.com/

ACT的開發工具已經整合在AEDT環境當中，不需要額外license也不需要另外安裝。

---

Q. Matplotlib庫的用途為何？

A. 科學數據需要透過圖表來呈現其行為或趨勢。Matplotlib庫的函式可以讓使用者將大量的數值資料轉換成各式得圖表。圖表的格式極為豐富，請參考：https://matplotlib.org/3.1.1/gallery/index.html

---
