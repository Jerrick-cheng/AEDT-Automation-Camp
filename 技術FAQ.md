Q. 可以簡單介紹一下AEDT的函式庫嗎？

A. AEDT函式庫分成Desktop, Project, Design, Editor, Module等大類，Module底下又分成多個小類。比方說是要在專案底下加入新的設計，我們便可以使用oProject.InsertDesign()函數來完成。從功能區分，可分成CURD(Create:
建立, Update:更新, Read:讀取, Delete:刪除)四大塊。比方說是InsertDesign()屬於建立, SetActiveDesign()算是更新，GetName()屬於讀取，CutDesign()屬於刪除。當中CUD類可以透過錄製得到，而R類需要透過文件來查找。關於函式庫的Help檔可以在C:\Program Files\AnsysEM\AnsysEM20.1\Win64\Help底下找到ScriptingGuide.pdf當中詳細說明了函式的功能及使用方法。

---

Q. 如何讓使用者輸入參數到腳本當中？

A. 由易到難，有下列幾種方法：
1. 讓使用者在AEDT Properties視窗輸入參數，缺點是無法建立複雜的控件，如下拉式選單，或Radio Button。
2. 建立使用者介面。在Iron Python當中，有兩種方法可以產生使用者介面：
    - Tkinter (Linux & Windows)，用代碼方式編寫，較為繁複。
    - WPF (Windows)，可用拖放方法建立GUI，程式與介面分離。
3. 包裝成ACT(ANSYS Customization Toolkit)，ACT當中有較多控件可以使用。

---

Q. 如何不讓別人看到我腳本的程式碼？

A. 有兩種手段:
1. 編譯成.dll
2. 包裝成ACT(ANSYS Customization Toolkit)

---



---

Q. Matplotlib庫的用途為何？

A. 科學數據需要透過圖表來呈現其行為或趨勢。Matplotlib庫的函式可以讓使用者將大量的數值資料轉換成各式得圖表。圖表的格式極為豐富，請參考：https://matplotlib.org/3.1.1/gallery/index.html

---

Q. 熟悉檔案的讀寫為何重要？

A. AEDT存在許多的的設定檔，比方說是材料設定檔，激發設定檔，堆疊設定檔。以文字檔格式紀錄。對前處理來說，讀取設定檔便可以取得必要的訊息，也可以透過修改檔案來更新設計參數。對後處理來說，模擬結果都可以匯出到檔案當中。因此熟悉檔案的讀寫，對模擬自動化是必要的技能。

---

Q. 什麼是parser?

A. 檔案採用的資料種類及方法，根據資料的格式及之後要進行的運算，我們必須選擇適當的資料結構來儲存，才能有效的完成後續的工作。解析檔案並儲存至資料結構的程式稱之為parser。最常見的csv檔為例，csv parser便是將csv檔案讀到list of list的資料結構，使用者可以輕鬆的使用切片來取得某一列，某一行的資料。

---

Q. 我要將資料結構寫道檔案當中，有哪些考量？

A. 如果不考慮可讀性，最簡單的方式便是用pickle寫到檔案當中。檔案以二進制儲存，具有一定的保護性。如果考量到可讀性，CSV, Jason, xml,都是不錯的方式，有現成的庫可以使用。如果是自訂格式，則程式碼必須適當的格式化資料結構來產生符合規範的檔案格式。這部分通常需要耗費不少的時間來開發。

---

Q. 如何編寫parser?

A. Parser一般採用物件導向的方式來編寫，以物件來儲存資料並提供了各式的函式來應付常用的資料查詢及輸出。

---

Q. 何謂物件導向？

A. 物件導向與函式一樣都是用來包裹程式碼以達到可復用的目的。與函式不同的是物件是資料與函式的複合體，直接連結了資料及對應的函式，提供了比函式更高的整合性。python當中所有的結構都是屬於物件。python的物件導向甚至提供了魔法函式，讓使用者可以用符號直接操作物件。這也是python獨特的優勢之一。

---

Q. 如何理解AEDT的函式？

A. 要理解函式，必須先從輸出入著手。一個函式可以有多個輸入參數，也可以沒有輸入參數。必須以正確的資料型態傳入參數，函式才能正常地完成運算或執行動作。假設參數x是以字串表示的數值，舉例來說“23”，那麼以整數型別傳入23是不被接受的。這是初學者經常犯的錯誤。同樣的，返回資料的型態可能是單純的整數或字串，也可能是物件。清楚返回值的資料格式才能正確的加以處理。在閱讀AEDT的函式說明時，先觀察輸入參數的型別，必要時可以編寫程式碼片段來測試。

---

Q. 如何判斷返回資料的格式？

A. 最簡單的方式便是利用type()來得到資料型態，透過dir()來得到可以使用的函式。這裡舉一個簡單的例子：

---

Q. 如何包裹AEDT函式？

A. 錄製下來的函式結構一般來說相當的複雜，需要通過重新包裝來簡化結構以方便之後的使用。只需要保留必要的參數，其他設定為固定值，即可大幅簡化了函式的結構，舉例來說

---

Q. 用python生成報告有何好處？

A. 一般在完成模擬之後，工程師必須輸出圖表並擷取必要的資料，複製貼上到word或ppt當中來產生報告，以提供給主管或客戶參考，這是一件吃力不討好的工作，資料一多整理起來更是苦不堪言，一旦設計改版，全部的工作又必須重來一次。如果將報告的生成工作自動化，便可以讓工程師可以從繁瑣的剪貼操作解脫，去從事更有價值的技術研究。

---

Q. AEDT就有提供繪圖的功能，為何還需要使用matplotlib？

A. 首先，AEDT的所提供的繪圖種類遠不及matplotlib豐富，處裡速度也稍嫌緩慢，當輸出的圖片數量一多，差異就明顯看得出來。此外，有些資料需要先行處理再進行繪圖，如果外部處理完再匯回AEDT作圖豈不是多此一舉。然而，仍然有些圖必須由AEDT匯出，像是3D結構體或3D遠場圖。

---

Q. 如何整合圖片及數據甚或文字來產生報告？

A. 報告生成可以透過html來完成，html提供了各式的標籤，我們可以透過標籤來格式化文件，產生不同的字型大小，顏色，表格等。透過標籤也可以連接圖片及影片檔。由於html是文字格式，只要了解標籤的使用方式，我們便可以輕易地完成報告的編排。之後透過瀏覽器便可以檢視報告，並輸出pdf檔。

另一種方式是輸出到ppt當中。由於ironpython基於微軟.NET框架，不需另外安裝庫即可以使用內建函式讀寫Word, Excel, PowerPoint 等檔案。但是這部分的程式碼較為繁複，有興趣者可以上網查詢相關函式的使用方式。

---

Q. 可以簡單的說明html標籤的使用方式嗎？

A. Html的標籤是由<標籤名></標籤名>所組成。像是&lt;H1>xxx&lt;/H1>當中xxx的輸出格式即是由標籤所控制。舉例來說H1到H6代表了不同標題文字的大小，可用來表示報告不同章節的副標題。所有的標籤定義可參考以下連結：https://www.w3schools.com/tags/ref_byfunc.asp

---

Q. 該如何在html當中產生表格？

A. 我們可以透過<table>標籤來建立表格。如果表格欄位很多且又存在合併欄位的話，要正確排列表格的標籤需要花一番功夫。所幸已經有人想到了這個問題，並提供了解決方法。底下的連結提供了視覺化工具，可以讓使用者透過點選的方式，輕易的建立表格格式並輸出對應的html標籤。只要加以包裹成函式，便可以輕鬆的輸出表格的html檔。

---

Q. 如何發展大程式碼？

A. 個人經驗，對自動化程式而言，100行以內算是小程式。中型程式則是100-1000行，超過1000行可以算是大程式。這裡的行數不包含空白行，註解。開發小程式不太需要考慮結構的問題。中型程式就必須以函數，甚至是物件導向來組織程式碼。大型程式會需要模組化。程式規模越大，除錯困難度也越高，因此需要考慮單元測試。

---


---



Q. 那麼說，溝通是一件很重要的事了？

A. 除非使用者與編程者是同一人，否則溝通是無可避免。溝通所花的時間與精力往往還超過編程工作本身。溝通是軟體工程當中一個很重要的課題。這也正是模擬自動化很難普及的一個原因。模擬軟體有許多深奧的理論及工法，這很難說給專職的程式設計師理解。因此，由模擬軟體的使用者來開發自動化程式相對是一個比較可行的途徑。

---


